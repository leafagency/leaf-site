$checkbox-pseudo-size: .25rem;

.form {
  &__fieldset {
    border: none;
    border-top: $border-default;
    margin: 0 0 $spacing-7 0;
    padding: 0;

    @media screen and (min-width: map-get($breakpoints, 'breakpoint-3')) {
      margin: 0 0 $spacing-8 0;
    }
  }

  &__legend {
    background-color: $color-white;
    color: $color-slate;
    font-size: $font-size-h3;
    font-weight: 700;
    margin-bottom: $spacing-4;
    padding-right: $spacing-5;
    position: relative;
  }

  &__grid {
    @media screen and (min-width: map-get($breakpoints, 'breakpoint-3')) {
      display: -ms-grid;
      display: grid;

      &--half {
        -ms-grid-columns: 1fr ($spacing-8) 1fr;
        grid-template-columns: 1fr 1fr;
        grid-column-gap: $spacing-8;
      }

      &--custom {
        -ms-grid-columns: 1fr ($spacing-8) 1fr;
        -ms-grid-rows: 100% $spacing-7 100% $spacing-7 100%;
        grid-template-columns: 1fr 1fr;
        grid-column-gap: $spacing-8;
        grid-row-gap: $spacing-7;
      }
    }
  }

  &__group {
    &:not(:last-child) {
      margin-bottom: $spacing-5;
    }

    @media screen and (min-width: map-get($breakpoints, 'breakpoint-3')) {
      &:not(:last-child) {
        margin-bottom: 0;
      }

      .form__grid--custom & {
        &:nth-child(1) {
          -ms-grid-row: 1;
          -ms-grid-column: 1;
          grid-column: 1;
        }

        &:nth-child(2) {
          -ms-grid-row: 1;
          -ms-grid-column: 3;
          -ms-grid-column-span: 3;
          grid-column: 2;
        }

        &:nth-child(3) {
          -ms-grid-row: 3;
          -ms-grid-column: 1;
          -ms-grid-column-span: 3;
          grid-column: 1 / 3;
        }
      }

      .form__grid--half & {
        &:nth-child(1) {
          -ms-grid-row: 1;
          -ms-grid-column: 1;
        }

        &:nth-child(2) {
          -ms-grid-row: 1;
          -ms-grid-column: 3;
        }
      }
    }
  }

  &__label {
    color: $color-slate;
    display: inline-block;
    font-family: $font-family-sans-serif-medium;
    margin-bottom: .1em;

    &--checkbox {
      color: $color-stone;
      font-size: $font-size-sm;
      margin: 0;

      &::before,
      &::after {
        content: '';
        position: absolute;
      }

      &::before {
        background: $color-smoke;
        border-radius: .125rem;
        height: $checkbox-pseudo-size;
        left: 0;
        top: 50%;
        transform: translateY(-53%);
        width: $checkbox-pseudo-size;

        @media screen and (min-width: map-get($breakpoints, 'breakpoint-3')) {
          transform: translateY(-54%);
        }

        @media screen and (min-width: map-get($breakpoints, 'breakpoint-4')) {
          transform: translateY(-60%);
        }
      }

      &::after {
        border: $border-style;
        border-color: $color-white;
        border-top-color: transparent;
        border-width: 0 0 $border-width-sm $border-width-sm;
        height: 6px;
        left: 4px;
        opacity: 0;
        top: 5px;
        transform: rotate(-45deg);
        width: 10px;

        @media screen and (min-width: map-get($breakpoints, 'breakpoint-3')) {
          border-width: 0 0 $border-width-lg $border-width-lg;
          height: 7px;
          left: 3px;
          top: 8px;
          width: 12px;
        }
      }
    }
  }

  &__input {
    appearance: none;
    background-color: $color-smoke;
    border: $border-width-base $border-style $color-smoke;
    border-radius: $border-radius-base;
    color: $color-slate;
    display: block;
    font-size: $font-size-sm;
    line-height: 1;
    margin: 0;
    padding: ($spacing-5) $spacing-5 $spacing-5;
    transition: border-color .15s $timing-ease-in-out;
    width: 100%;

    &--textarea {
      height: auto;
      min-height: 10em;
      resize: vertical;
    }

    &.erroneous {
      border: $border-width-base $border-style $color-coral;
    }
  }

  &__checkboxes {
    margin-top: $spacing-5;
  }

  &__checkbox {
    margin-bottom: $spacing-3;
    padding-left: $spacing-6;
    position: relative;

    @media screen and (min-width: map-get($breakpoints, 'breakpoint-1')) {
      padding-left: $spacing-6;
    }
  }

  &__checkbox-input {
    margin: 0;
    opacity: 0;
    position: absolute;
    z-index: z('default');

    &:checked + .form__label--checkbox::before {
      background: var(--color-accent);
    }

    &:checked + .form__label--checkbox::after {
      opacity: 1;
    }
  }

  .error {
    color: $color-coral;
    font-size: $font-size-xs;
  }
}
